import{K as Q,m as R,r as c,j as e,L as q}from"./app-BzdOADVP.js";import{A as K,S as z,a as G,b as J,c as W,d as Z,e as _,f as $,g as Y}from"./app-layout-DJJLhKv_.js";import{B as p}from"./app-logo-icon-BkO5Ozxv.js";import{A as T,a as k,b as A}from"./alert-DjTGgkbr.js";import{T as ee}from"./sonner-C79GmkCj.js";import{t}from"./index-DxeJ8Bvu.js";import{I as N}from"./input-DFu5t9Bc.js";import{L as u}from"./label-Dppx2W-H.js";import{P as se}from"./pagination-BB0cugiz.js";import{T as te,a as ne,b as I,c as i,d as re,e as h}from"./table-0haSWtSt.js";import{A as ae,a as le,b as ce,c as ie,d as he,e as oe,f as de,g as me}from"./alert-dialog-D5ivzF93.js";import{M as w}from"./megaphone-CNCpStSD.js";import"./index-CK31Y0Kf.js";import"./index-C1afcH4J.js";const xe=[{title:"Quản lý năm học",href:"/academicyears"}];function Ie({academicYears:l}){var y;const n=(y=Q().props)==null?void 0:y.flash,{data:o,setData:d,post:L,processing:j,errors:r,reset:g,delete:H,put:O}=R({name:"",startDate:"",endDate:"",semesterCount:2}),[F,f]=c.useState(!1),[v,b]=c.useState(null),[E,C]=c.useState(null),[S,P]=c.useState(null),[X,m]=c.useState(!1),[x,D]=c.useState(!1),B=(s,a)=>{b(s),C(a),m(!0)},U=()=>{v!==null&&H(route("academicyears.destroy",v),{onSuccess:()=>{t.success("Xóa năm học thành công"),m(!1),b(null),C("")},onError:s=>{var a;s.reference?(a=s.reference)!=null&&a.includes("cấu hình lương")?t.error(s.reference,{duration:1e4}):t.error(s.reference):t.error("Xóa năm học thất bại"),m(!1)}})},V=s=>{s.preventDefault(),x?S!==null?O(route("academicyears.update",S),{onSuccess:()=>{t.success("Cập nhật năm học thành công"),g(),f(!1),D(!1)},onError:()=>{t.error("Cập nhật năm học thất bại"),D(!1)}}):t.error("Thông tin năm học không được để trống khi cập nhật"):L(route("academicyears.store"),{onSuccess:()=>{t.success("Thêm năm học mới thành công"),g(),f(!1)},onError:()=>{t.error("Thêm năm học mới thất bại")}})},M=s=>{f(s),s||(g(),D(!1),P(null))};return e.jsxs(K,{breadcrumbs:xe,children:[e.jsx(ee,{}),e.jsx(q,{title:"Quản lý năm học"}),e.jsx("div",{className:"m-4",children:e.jsxs(z,{open:F,onOpenChange:M,children:[e.jsx(G,{asChild:!0,children:e.jsx(p,{variant:"default",className:"hover:cursor-pointer",children:"Thêm năm học mới"})}),e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(Z,{children:x?"Chỉnh sửa thông tin năm học":"Thêm năm học mới"}),e.jsx(_,{children:"Nhập thông tin năm học và số lượng học kỳ"})]}),e.jsx("form",{onSubmit:V,id:"academic-year-form",className:"space-y-6 p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"name",children:"Tên năm học"}),e.jsx(N,{id:"name",value:o.name,onChange:s=>d("name",s.target.value),className:"w-full",placeholder:"VD: Năm học 2023-2024"}),r.name&&e.jsx("p",{className:"text-sm text-red-500",children:r.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"startDate",children:"Ngày bắt đầu"}),e.jsx(N,{id:"startDate",value:o.startDate,onChange:s=>d("startDate",s.target.value),type:"date",className:"w-full"}),r.startDate&&e.jsx("p",{className:"text-sm text-red-500",children:r.startDate})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"endDate",children:"Ngày kết thúc"}),e.jsx(N,{id:"endDate",value:o.endDate,onChange:s=>d("endDate",s.target.value),type:"date",className:"w-full"}),r.endDate&&e.jsx("p",{className:"text-sm text-red-500",children:r.endDate})]}),!x&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"semesterCount",children:"Số lượng học kỳ"}),e.jsxs("select",{id:"semesterCount",value:o.semesterCount,onChange:s=>d("semesterCount",parseInt(s.target.value)),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:1,children:"1 học kỳ"}),e.jsx("option",{value:2,children:"2 học kỳ"}),e.jsx("option",{value:3,children:"3 học kỳ"})]}),r.semesterCount&&e.jsx("p",{className:"text-sm text-red-500",children:r.semesterCount})]})]})}),e.jsxs($,{children:[e.jsx(Y,{asChild:!0,children:e.jsx(p,{variant:"outline",type:"button",className:"hover:cursor-pointer",children:"Thoát"})}),e.jsx(p,{type:"submit",form:"academic-year-form",disabled:j,className:"hover:cursor-pointer",children:j?"Đang xử lý...":x?"Cập nhật":"Thêm mới"})]})]})]})}),e.jsx("div",{className:"m-4",children:e.jsxs("div",{children:[(n==null?void 0:n.message)&&e.jsxs(T,{children:[e.jsx(w,{className:"h-4 w-4"}),e.jsx(k,{children:"Thông báo"}),e.jsx(A,{children:n.message})]}),(n==null?void 0:n.error)&&e.jsxs(T,{variant:"destructive",children:[e.jsx(w,{className:"h-4 w-4"}),e.jsx(k,{children:"Lỗi"}),e.jsx(A,{children:n.error})]})]})}),l.data.length>0?e.jsxs("div",{className:"m-4",children:[e.jsxs(te,{children:[e.jsx(ne,{children:e.jsxs(I,{children:[e.jsx(i,{className:"w-[100px]",children:"ID"}),e.jsx(i,{children:"Tên năm học"}),e.jsx(i,{children:"Ngày bắt đầu"}),e.jsx(i,{children:"Ngày kết thúc"}),e.jsx(i,{children:"Số học kỳ"}),e.jsx(i,{className:"text-center",children:"Hành động"})]})}),e.jsx(re,{children:l.data.map(s=>{var a;return e.jsxs(I,{children:[e.jsx(h,{className:"font-medium",children:s.id}),e.jsx(h,{children:s.name}),e.jsx(h,{children:new Date(s.startDate).toLocaleDateString("vi-VN")}),e.jsx(h,{children:new Date(s.endDate).toLocaleDateString("vi-VN")}),e.jsx(h,{children:((a=s.semesters)==null?void 0:a.length)||0}),e.jsx(h,{className:"text-center space-x-2",children:e.jsx(p,{disabled:j,onClick:()=>B(s.id,s.name),className:"bg-red-500 hover:bg-red-700 hover:cursor-pointer",children:"Xoá"})})]},s.id)})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(se,{links:l.links||[],from:l.from||0,to:l.to||0,total:l.total||0})})]}):e.jsx("div",{className:"m-4",children:e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Chưa có năm học nào được tạo"})})}),e.jsx(ae,{open:X,onOpenChange:m,children:e.jsxs(le,{children:[e.jsxs(ce,{children:[e.jsx(ie,{children:"Xác nhận xoá"}),e.jsxs(he,{children:["Bạn có chắc chắn muốn xoá năm học ",e.jsx("strong",{children:E})," không? Hành động này sẽ xoá tất cả học kỳ liên quan và không thể hoàn tác."]})]}),e.jsxs(oe,{children:[e.jsx(de,{className:"hover:cursor-pointer",children:"Huỷ"}),e.jsx(me,{className:"hover:cursor-pointer bg-red-600 hover:bg-red-700",onClick:U,children:"Xác nhận"})]})]})})]})}export{Ie as default};
