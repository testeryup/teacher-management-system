import{j as e,L as k}from"./app-BzdOADVP.js";import{A as F,m as L,B as D,T as P}from"./app-layout-DJJLhKv_.js";import{C as l,a as c,b as i,c as n,d as m}from"./card-Cs6Ji-ep.js";import{B as f}from"./badge-D3QJI1i6.js";import{B as u}from"./app-logo-icon-BkO5Ozxv.js";import{T as N,a as p,b as j,c as r,d as b,e as t}from"./table-0haSWtSt.js";import{S as y}from"./school-lm7QtGkB.js";import{E as R}from"./eye-fIjAslyx.js";import{D as A}from"./download-CFjlwEKO.js";import{B as G}from"./building-2-elMs-EHZ.js";import{U as E}from"./users-Mxzx9_FF.js";import{T as K,P as V,a as _}from"./PieChart-i-EZmBzX.js";import{R as v,b as $,T as w,L as H,B as X,C as O,X as U,Y as M,a as Q}from"./BarChart-iYCdpAxk.js";import{A as q}from"./award-BW1onu3v.js";import"./index-CK31Y0Kf.js";import"./index-C1afcH4J.js";const C=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#84CC16"];function xe({academicYear:o,departmentsData:h,schoolTotals:x}){const T=[{title:"Tổng quan",href:"/dashboard"},{title:"Báo cáo tiền dạy",href:"/reports"},{title:"Báo cáo toàn trường",href:"#"}],d=s=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(s),g=h.map((s,a)=>({name:s.department.abbrName,value:s.totalSalary,percentage:(s.totalSalary/x.totalSalary*100).toFixed(1),color:C[a%C.length]})),B=h.map(s=>({name:s.department.abbrName,salary:s.totalSalary,teachers:s.teachersCount,classes:s.totalClasses})),S=h.flatMap(s=>s.teachers.map(a=>({...a,departmentName:s.department.abbrName}))).sort((s,a)=>a.totalSalary-s.totalSalary).slice(0,10);return e.jsxs(F,{breadcrumbs:T,children:[e.jsx(k,{title:`Báo cáo toàn trường - ${o.name}`}),e.jsxs("div",{className:"container mx-auto px-6 py-8 space-y-8",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(y,{className:"h-6 w-6 text-purple-600"})}),"Báo cáo toàn trường"]}),e.jsxs("p",{className:"text-muted-foreground text-lg",children:["Tổng hợp lương giảng viên - Năm học ",o.name]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{variant:"outline",onClick:()=>{const s=`/reports/export-pdf?type=school&academic_year_id=${o.id}`;window.open(s,"_blank")},children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Xem trước PDF"]}),e.jsxs(u,{onClick:()=>{const s=`/reports/export-pdf?type=school&academic_year_id=${o.id}`;window.location.href=s},className:"bg-red-600 hover:bg-red-700",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Tải PDF"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Tổng khoa"}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:x.totalDepartments})})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Tổng GV"}),e.jsx(E,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:x.totalTeachers})})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Tổng lương"}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:d(x.totalSalary)})})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Tổng lớp"}),e.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:x.totalClasses})})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"TB/GV"}),e.jsx(K,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:d(x.averageSalaryPerTeacher)})})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"TB/Khoa"}),e.jsx(P,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:d(x.averageSalaryPerDepartment)})})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(i,{children:"Phân bổ lương theo khoa"}),e.jsx(m,{children:"Tỷ lệ chi phí lương của từng khoa"})]}),e.jsxs(n,{children:[e.jsx(v,{width:"100%",height:300,children:e.jsxs(V,{children:[e.jsx(_,{data:g,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",children:g.map((s,a)=>e.jsx($,{fill:s.color},`cell-${a}`))}),e.jsx(w,{formatter:s=>d(s)}),e.jsx(H,{})]})}),e.jsx("div",{className:"mt-4 space-y-2",children:g.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.color}}),e.jsx("span",{children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:d(s.value)}),e.jsxs("span",{className:"text-muted-foreground",children:["(",s.percentage,"%)"]})]})]},a))})]})]}),e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(i,{children:"So sánh các khoa"}),e.jsx(m,{children:"Tổng lương và số lượng giảng viên theo khoa"})]}),e.jsx(n,{children:e.jsx(v,{width:"100%",height:300,children:e.jsxs(X,{data:B,children:[e.jsx(O,{strokeDasharray:"3 3"}),e.jsx(U,{dataKey:"name"}),e.jsx(M,{tickFormatter:s=>(s/1e6).toFixed(1)+"M"}),e.jsx(w,{formatter:(s,a)=>a==="salary"?[d(s),"Tổng lương"]:[s,a==="teachers"?"Giảng viên":"Lớp học"]}),e.jsx(Q,{dataKey:"salary",fill:"#10B981",radius:[4,4,0,0]})]})})})]})]}),e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"Top 10 giảng viên có lương cao nhất"]}),e.jsx(m,{children:"Xếp hạng giảng viên theo tổng lương trong năm học"})]}),e.jsx(n,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(N,{children:[e.jsx(p,{children:e.jsxs(j,{children:[e.jsx(r,{className:"w-12",children:"Hạng"}),e.jsx(r,{children:"Giảng viên"}),e.jsx(r,{children:"Khoa"}),e.jsx(r,{className:"text-center",children:"Lớp học"}),e.jsx(r,{className:"text-center",children:"Tiết QĐ"}),e.jsx(r,{className:"text-right",children:"Tổng lương"})]})}),e.jsx(b,{children:S.map((s,a)=>e.jsxs(j,{children:[e.jsx(t,{children:e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${a===0?"bg-yellow-100 text-yellow-800":a===1?"bg-gray-100 text-gray-800":a===2?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:a+1})}),e.jsx(t,{className:"font-medium",children:s.teacher.fullName}),e.jsx(t,{children:e.jsx(f,{variant:"outline",children:s.departmentName})}),e.jsx(t,{className:"text-center",children:s.totalClasses}),e.jsx(t,{className:"text-center",children:s.totalLessons.toFixed(1)}),e.jsx(t,{className:"text-right font-bold text-green-600",children:d(s.totalSalary)})]},s.teacher.id))})]})})})]}),e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(i,{children:"Chi tiết theo khoa"}),e.jsx(m,{children:"Tổng hợp thông tin lương của từng khoa"})]}),e.jsx(n,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(N,{children:[e.jsx(p,{children:e.jsxs(j,{children:[e.jsx(r,{children:"Khoa"}),e.jsx(r,{className:"text-center",children:"Giảng viên"}),e.jsx(r,{className:"text-center",children:"Lớp học"}),e.jsx(r,{className:"text-center",children:"Tiết QĐ"}),e.jsx(r,{className:"text-right",children:"Tổng lương"}),e.jsx(r,{className:"text-right",children:"TB/GV"}),e.jsx(r,{className:"text-center",children:"% Tổng"})]})}),e.jsx(b,{children:h.map(s=>e.jsxs(j,{children:[e.jsx(t,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.department.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.department.abbrName})]})}),e.jsx(t,{className:"text-center",children:s.teachersCount}),e.jsx(t,{className:"text-center",children:s.totalClasses}),e.jsx(t,{className:"text-center",children:s.totalLessons.toFixed(1)}),e.jsx(t,{className:"text-right font-bold text-green-600",children:d(s.totalSalary)}),e.jsx(t,{className:"text-right",children:d(s.totalSalary/s.teachersCount)}),e.jsx(t,{className:"text-center",children:e.jsxs(f,{variant:"secondary",children:[(s.totalSalary/x.totalSalary*100).toFixed(1),"%"]})})]},s.department.id))})]})})})]}),h.length===0&&e.jsx(l,{children:e.jsxs(n,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(y,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"Chưa có dữ liệu lương"}),e.jsxs("p",{className:"text-muted-foreground text-center",children:["Chưa có khoa nào có dữ liệu lương trong năm học ",o.name,"."]})]})})]})]})}export{xe as default};
