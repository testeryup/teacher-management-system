import{r as W,j as e,L as X,S as O}from"./app-BzdOADVP.js";import{A as Z,m as u,B as $,T as ee}from"./app-layout-DJJLhKv_.js";import{C as m,a as x,b as h,c as o}from"./card-Cs6Ji-ep.js";import{B as b}from"./badge-D3QJI1i6.js";import{B as R}from"./app-logo-icon-BkO5Ozxv.js";import{L as v}from"./label-Dppx2W-H.js";import{S as E,a as I,b as U,c as q,d as g}from"./select-OCxlDRz8.js";import{T as se,a as ae,b as _,c as j,d as le,e as d}from"./table-0haSWtSt.js";import{U as te}from"./users-Mxzx9_FF.js";import{B as ne}from"./building-2-elMs-EHZ.js";import{F as K}from"./filter-C1TH0Smz.js";import{R as ie}from"./rotate-ccw-zuwDQO56.js";import{C as ce}from"./calculator-BGAZN5Ev.js";import"./index-CK31Y0Kf.js";import"./index-C1afcH4J.js";import"./chevron-down-CEWiBjPz.js";const re=[{title:"Bảng lương của tôi",href:"/teacher/salary"}];function Te({teacher:n,academicYears:M,semesters:S,salaryData:p,summary:i,filters:y}){var A,w,B;const[c,T]=W.useState({academic_year_id:y.academic_year_id||"all",semester_id:y.semester_id||"all"}),r=s=>{if(s==null)return 0;const l=Number(s);return isNaN(l)?0:l},f=(s,l=1)=>r(s).toFixed(l),N=s=>{const l=r(s);return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(l)},Y=s=>{const l=r(s);return new Intl.NumberFormat("vi-VN").format(l)},P=s=>Array.isArray(s)?s.reduce((l,t)=>l+r(t==null?void 0:t.total_salary),0):0,z=s=>Array.isArray(s)?s.reduce((l,t)=>l+r(t==null?void 0:t.converted_lessons),0):0,C=(s,l)=>{const t={...c,[s]:l};s==="academic_year_id"&&(t.semester_id="all"),T(t)},D=()=>{const s=Object.fromEntries(Object.entries(c).map(([l,t])=>[l,t==="all"?"":t]));O.get("/teacher/salary",s,{preserveState:!0,preserveScroll:!0})},G=()=>{T({academic_year_id:"all",semester_id:"all"}),O.get("/teacher/salary",{},{preserveState:!0,preserveScroll:!0})},J=c.academic_year_id&&c.academic_year_id!=="all"?S.filter(s=>s.academicYear.id.toString()===c.academic_year_id):S;return e.jsxs(Z,{breadcrumbs:re,children:[e.jsx(X,{title:"Bảng lương của tôi"}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5"}),"Thông tin giảng viên"]})}),e.jsx(o,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Họ tên:"}),e.jsx("span",{children:(n==null?void 0:n.fullName)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Khoa:"}),e.jsx(b,{variant:"outline",children:((A=n==null?void 0:n.department)==null?void 0:A.abbrName)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Bằng cấp:"}),e.jsx("span",{children:((w=n==null?void 0:n.degree)==null?void 0:w.name)||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Hệ số lương:"}),e.jsx(b,{variant:"secondary",children:r((B=n==null?void 0:n.degree)==null?void 0:B.baseSalaryFactor)})]})]})})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5"}),"Bộ lọc"]})}),e.jsx(o,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Năm học"}),e.jsxs(E,{value:c.academic_year_id,onValueChange:s=>C("academic_year_id",s),children:[e.jsx(I,{children:e.jsx(U,{placeholder:"Chọn năm học"})}),e.jsxs(q,{children:[e.jsx(g,{value:"all",children:"Tất cả năm học"}),M.map(s=>e.jsx(g,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Học kỳ"}),e.jsxs(E,{value:c.semester_id,onValueChange:s=>C("semester_id",s),children:[e.jsx(I,{children:e.jsx(U,{placeholder:"Chọn học kỳ"})}),e.jsxs(q,{children:[e.jsx(g,{value:"all",children:"Tất cả học kỳ"}),J.map(s=>e.jsxs(g,{value:s.id.toString(),children:[s.name," (",s.academicYear.name,")"]},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{className:"invisible",children:"Actions"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(R,{onClick:D,className:"flex-1",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Lọc"]}),e.jsx(R,{variant:"outline",onClick:G,children:e.jsx(ie,{className:"w-4 h-4"})})]})]})]})})]}),(c.academic_year_id!=="all"||c.semester_id!=="all")&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(m,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:[e.jsx(x,{className:"pb-2",children:e.jsxs(h,{className:"text-sm font-medium text-green-700 flex items-center gap-2",children:[e.jsx(u,{className:"h-4 w-4"}),"Tổng lương"]})}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold text-green-900",children:N(i==null?void 0:i.totalSalary)})})]}),e.jsxs(m,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:[e.jsx(x,{className:"pb-2",children:e.jsxs(h,{className:"text-sm font-medium text-blue-700 flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"Số lớp dạy"]})}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:Y(i==null?void 0:i.totalClasses)})})]}),e.jsxs(m,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:[e.jsx(x,{className:"pb-2",children:e.jsxs(h,{className:"text-sm font-medium text-purple-700 flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Tiết quy đổi"]})}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold text-purple-900",children:f(i==null?void 0:i.totalLessons)})})]}),e.jsxs(m,{className:"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:[e.jsx(x,{className:"pb-2",children:e.jsxs(h,{className:"text-sm font-medium text-orange-700 flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Lương TB/lớp"]})}),e.jsx(o,{children:e.jsx("div",{className:"text-2xl font-bold text-orange-900",children:N(i==null?void 0:i.averageSalaryPerClass)})})]})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),"Chi tiết lương theo học kỳ"]})}),e.jsx(o,{children:p&&Object.keys(p).length>0?e.jsx("div",{className:"space-y-6",children:Object.entries(p).map(([s,l])=>{const t=P(l),Q=z(l);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s||"N/A"}),e.jsx("div",{className:"flex gap-4 text-sm text-muted-foreground",children:e.jsxs("span",{children:[Array.isArray(l)?l.length:0," lớp •",N(t)]})})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(se,{children:[e.jsx(ae,{children:e.jsxs(_,{children:[e.jsx(j,{children:"Lớp học"}),e.jsx(j,{children:"Môn học"}),e.jsx(j,{className:"text-center",children:"Số tiết"}),e.jsx(j,{className:"text-center",children:"Hệ số lớp"}),e.jsx(j,{className:"text-center",children:"Hệ số môn"}),e.jsx(j,{className:"text-center",children:"Tiết quy đổi"}),e.jsx(j,{className:"text-right",children:"Lương"})]})}),e.jsxs(le,{children:[Array.isArray(l)&&l.map(a=>{var F,L,k,H,V;return e.jsxs(_,{children:[e.jsx(d,{className:"font-medium",children:((F=a==null?void 0:a.classroom)==null?void 0:F.name)||"N/A"}),e.jsx(d,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:((k=(L=a==null?void 0:a.classroom)==null?void 0:L.course)==null?void 0:k.name)||"N/A"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:((V=(H=a==null?void 0:a.classroom)==null?void 0:H.course)==null?void 0:V.code)||"N/A"})]})}),e.jsx(d,{className:"text-center",children:r(a==null?void 0:a.actual_lessons)}),e.jsx(d,{className:"text-center",children:e.jsxs(b,{variant:r(a==null?void 0:a.class_coefficient)>=0?"default":"destructive",children:[r(a==null?void 0:a.class_coefficient)>=0?"+":"",r(a==null?void 0:a.class_coefficient)]})}),e.jsx(d,{className:"text-center",children:r(a==null?void 0:a.course_coefficient)}),e.jsx(d,{className:"text-center font-medium",children:f(a==null?void 0:a.converted_lessons)}),e.jsx(d,{className:"text-right font-bold text-green-600",children:N(a==null?void 0:a.total_salary)})]},(a==null?void 0:a.id)||Math.random())}),e.jsxs(_,{className:"bg-muted/50",children:[e.jsxs(d,{colSpan:5,className:"font-bold",children:["Tổng ",s||"N/A"]}),e.jsx(d,{className:"text-center font-bold",children:f(Q)}),e.jsx(d,{className:"text-right font-bold text-green-600",children:N(t)})]})]})]})})]},s)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(u,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"Chưa có dữ liệu lương"}),e.jsx("p",{className:"text-muted-foreground",children:c.academic_year_id!=="all"||c.semester_id!=="all"?"Không có dữ liệu lương cho kỳ học đã chọn.":"Vui lòng chọn năm học hoặc học kỳ để xem dữ liệu lương."})]})})]})]})]})}export{Te as default};
