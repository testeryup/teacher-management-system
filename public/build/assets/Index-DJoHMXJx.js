import{K,m as Q,r as l,j as e,L as R}from"./app-BzdOADVP.js";import{A as q,S as $,a as z,b as G,c as J,d as M,e as V,f as W,g as Y}from"./app-layout-DJJLhKv_.js";import{B as o}from"./app-logo-icon-BkO5Ozxv.js";import{T as Z}from"./sonner-C79GmkCj.js";import{t as n}from"./index-DxeJ8Bvu.js";import{I as y}from"./input-DFu5t9Bc.js";import{L as T}from"./label-Dppx2W-H.js";import{P as _}from"./pagination-BB0cugiz.js";import{T as D,a as C,b as j,c as r,d as ee,e as m}from"./table-0haSWtSt.js";import{A as se,a as ne,b as ae,c as re,d as te,e as le,f as ce,g as oe}from"./alert-dialog-D5ivzF93.js";import"./index-CK31Y0Kf.js";import"./index-C1afcH4J.js";const ie=[{title:"Quản lý bằng cấp",href:"/degrees"}];function ye({degrees:a}){var N,v;(N=K().props)==null||N.flash;const{data:t,setData:p,post:F,processing:g,reset:c,delete:H,put:k}=Q({name:"",baseSalaryFactor:0}),[A,i]=l.useState(!1),[b,I]=l.useState(null),[O,E]=l.useState(null),[f,S]=l.useState(null),[w,h]=l.useState(!1),[x,d]=l.useState(!1),B=(s,u)=>{I(s),E(u),h(!0)},L=()=>{b!==null&&H(route("degrees.destroy",b),{onSuccess:()=>{n.success("Xoá bằng cấp thành công"),h(!1)},onError:s=>{s.reference?n.error(`Không thể xoá bằng cấp này: ${s.reference}`):n.error("Xoá bằng cấp thất bại"),h(!1)}})},P=s=>{if(s.preventDefault(),console.log("check data:",t),!t.name.trim()){n.error("Tên bằng cấp là bắt buộc");return}if(!t.baseSalaryFactor||t.baseSalaryFactor<=0){n.error("Hệ số lương phải lớn hơn 0");return}if(t.baseSalaryFactor>5){n.error("Hệ số lương không được vượt quá 5.0");return}x?f!==null?k(route("degrees.update",f),{onSuccess:()=>{n.success("Cập nhật bằng cấp thành công"),c(),i(!1),d(!1)},onError:()=>{n.error("Cập nhật bằng cấp thất bại"),c(),d(!1)}}):n.error("Bằng cấp không được để trống khi update"):F(route("degrees.store"),{onSuccess:()=>{n.success("Thêm bằng cấp mới thành công"),c(),i(!1)},onError:u=>{console.log("check errors onError:",u),n.error("Thêm bằng cấp mới thất bại"),c()}})};function U(s){d(!0),p({...s}),S(s.id),i(!0)}const X=s=>{i(s),s||(c(),d(!1),S(null))};return e.jsxs(q,{breadcrumbs:ie,children:[e.jsx(Z,{}),e.jsx(R,{title:"Quản lý bằng cấp"}),e.jsx("div",{className:"m-4",children:e.jsxs($,{open:A,onOpenChange:X,children:[e.jsx(z,{asChild:!0,children:e.jsx(o,{variant:"default",className:"hover:cursor-pointer",children:"Thêm bằng cấp mới"})}),e.jsxs(G,{children:[e.jsxs(J,{children:[e.jsx(M,{children:x?"Chỉnh sửa thông tin bằng cấp":"Thêm bằng cấp mới"}),e.jsx(V,{children:"Nhập thông tin ở đây, sau đó nhấn lưu"})]}),e.jsx("form",{onSubmit:P,id:"degree-form",children:e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(T,{htmlFor:"name",className:"text-right",children:"Tên bằng cấp"}),e.jsx(y,{id:"name",value:t.name,onChange:s=>p("name",s.target.value),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(T,{htmlFor:"baseSalaryFactor",className:"text-right",children:"Hệ số lương"}),e.jsx(y,{id:"baseSalaryFactor",value:t.baseSalaryFactor,onChange:s=>p("baseSalaryFactor",parseFloat(s.target.value)||0),className:"col-span-3",type:"number",step:"0.1",min:"0"})]})]})}),e.jsxs(W,{children:[e.jsx(Y,{asChild:!0,children:e.jsx(o,{variant:"outline",type:"button",className:"hover:cursor-pointer",children:"Thoát"})}),e.jsx(o,{type:"submit",form:"degree-form",disabled:g,className:"hover:cursor-pointer",children:x?"Sửa thông tin":"Thêm mới"})]})]})]})}),a.data.length>0?e.jsx("div",{className:"m-4",children:e.jsxs(D,{children:[e.jsx(C,{children:e.jsxs(j,{children:[e.jsx(r,{className:"w-[100px]",children:"Id"}),e.jsx(r,{children:"Tên bằng cấp"}),e.jsx(r,{children:"Hệ số lương"}),e.jsx(r,{className:"text-center",children:"Hành động"})]})}),e.jsx(ee,{children:(v=a==null?void 0:a.data)==null?void 0:v.map(s=>e.jsxs(j,{children:[e.jsx(m,{className:"font-medium",children:s.id}),e.jsx(m,{children:s.name}),e.jsx(m,{children:s.baseSalaryFactor}),e.jsxs(m,{className:"text-center space-x-2",children:[e.jsx(o,{disabled:g,onClick:()=>U(s),className:"bg-yellow-500 hover:bg-yellow-700 hover:cursor-pointer",children:"Sửa"}),e.jsx(o,{disabled:g,onClick:()=>B(s.id,s.name),className:"bg-red-500 hover:bg-red-700 hover:cursor-pointer",children:"Xoá"})]})]},s.id))})]})}):e.jsx("div",{className:"m-4",children:e.jsx(D,{children:e.jsx(C,{children:e.jsxs(j,{children:[e.jsx(r,{className:"w-[100px]",children:"Id"}),e.jsx(r,{children:"Tên bằng cấp"}),e.jsx(r,{children:"Hệ số lương"}),e.jsx(r,{className:"text-center",children:"Hành động"})]})})})}),e.jsx("div",{className:"mx-4",children:e.jsx(_,{links:a.links,from:a.from,to:a.to,total:a.total})}),e.jsx(se,{open:w,onOpenChange:h,children:e.jsxs(ne,{children:[e.jsxs(ae,{children:[e.jsx(re,{children:"Xác nhận xoá"}),e.jsxs(te,{children:["Bạn có chắc chắn muốn xoá bằng cấp ",e.jsx("strong",{children:O})," không? Hành động này không thể hoàn tác."]})]}),e.jsxs(le,{children:[e.jsx(ce,{className:"hover:cursor-pointer",children:"Huỷ"}),e.jsx(oe,{className:"hover:cursor-pointer",onClick:L,children:"Xác nhận"})]})]})})]})}export{ye as default};
